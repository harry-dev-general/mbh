<!DOCTYPE html>
<html>
<head>
    <title>Availability Time Format Test</title>
</head>
<body>
    <h1>Testing Time Format Issues</h1>
    
    <div>
        <h2>Browser Time Input Test</h2>
        <input type="time" id="testTime" value="09:00">
        <button onclick="testTimeInput()">Test Time Input</button>
        <div id="timeInputResult"></div>
    </div>
    
    <div>
        <h2>Format Time Function Test</h2>
        <button onclick="testFormatTime()">Test Format Time Function</button>
        <div id="formatTimeResult"></div>
    </div>
    
    <div>
        <h2>Test Full Submission Flow</h2>
        <button onclick="testSubmissionFlow()">Test Submission</button>
        <div id="submissionResult"></div>
    </div>

    <script>
        // Copy of formatTime function from availability.html
        function formatTime(time24) {
            if (!time24) return '';
            const [hours, minutes] = time24.split(':');
            const h = parseInt(hours);
            const ampm = h >= 12 ? 'PM' : 'AM';
            const h12 = h % 12 || 12;
            return `${h12}:${minutes} ${ampm}`;
        }
        
        function testTimeInput() {
            const timeInput = document.getElementById('testTime');
            const value = timeInput.value;
            const formatted = formatTime(value);
            
            document.getElementById('timeInputResult').innerHTML = `
                <p>Raw input value: "${value}"</p>
                <p>After formatTime(): "${formatted}"</p>
                <p>formatTime() called twice: "${formatTime(formatted)}"</p>
            `;
        }
        
        function testFormatTime() {
            const tests = [
                '09:00',      // Morning 24h
                '17:00',      // Evening 24h
                '9:00 AM',    // Already formatted
                '5:00 PM',    // Already formatted
                '9:00 AM AM', // Double AM
                '5:00 PM AM'  // Wrong double
            ];
            
            let results = '<h3>Format Time Test Results:</h3>';
            tests.forEach(test => {
                const result = formatTime(test);
                results += `<p>Input: "${test}" â†’ Output: "${result}"</p>`;
            });
            
            document.getElementById('formatTimeResult').innerHTML = results;
        }
        
        async function testSubmissionFlow() {
            const testData = {
                fields: {
                    "Monday From": "09:00",
                    "Monday Until": "17:00"
                }
            };
            
            // Format the times
            testData.fields["Monday From"] = formatTime(testData.fields["Monday From"]);
            testData.fields["Monday Until"] = formatTime(testData.fields["Monday Until"]);
            
            document.getElementById('submissionResult').innerHTML = `
                <h3>Data that would be sent to Airtable:</h3>
                <pre>${JSON.stringify(testData, null, 2)}</pre>
                <p>Monday From: "${testData.fields["Monday From"]}"</p>
                <p>Monday Until: "${testData.fields["Monday Until"]}"</p>
            `;
        }
    </script>
</body>
</html>
